<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Valheim Modpack — Guia Completo</title>
  <meta name="color-scheme" content="dark">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    :root{
      /* Paleta RPG low-poly baseada no vermelho */
      --bg:#0d0a0f;
      --bg-2:#131018;
      --card:#17131c;
      --card-2:#1d1622;
      --primary:#e11d48;        /* vermelho principal */
      --primary-700:#9f1239;    /* sombra vermelho */
      --accent:#f5b728;         /* dourado */
      --accent-2:#20cfe3;       /* ciano complementar */
      --muted:#e8e6ed;
      --muted-2:#a7a4af;
      --chip:#241a22;
      --chip-b:#34202a;
      --ring:rgba(225,29,72,.25);
      --shadow:rgba(0,0,0,.45);
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--muted);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif}
    a{color:var(--accent-2);text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:1200px;margin:0 auto;padding:28px 18px 80px}
    header{
      border-radius:20px;
      padding:32px 24px 28px;
      background:
        radial-gradient(1200px 420px at 80% -40%, rgba(225,29,72,.20), transparent 60%),
        radial-gradient(900px 380px at -10% -30%, rgba(245,183,40,.18), transparent 55%),
        linear-gradient(180deg,#130e12 0%, #0e0b0f 100%);
      box-shadow: 0 10px 30px var(--shadow), inset 0 0 0 1px #201820;
    }
    .title{
      font-family:"Press Start 2P", system-ui, sans-serif;
      font-size:clamp(22px,3.2vw,44px);
      line-height:1.2;letter-spacing:.5px;color:#fff;text-shadow:0 2px 0 #000;
      margin:0 0 10px;text-align:center;
    }
    .subtitle{ text-align:center;font-size:14px;color:var(--muted-2);margin:0 auto 18px;max-width:820px}
    .tabs{ display:flex; gap:8px; justify-content:center; margin:10px 0 18px}
    .tab{
      padding:10px 14px;border-radius:999px;border:1px solid #3a2430;background:#140f14;color:#fff;
      cursor:pointer;font-weight:700;letter-spacing:.2px;transition:.15s;
    }
    .tab.on{
      background:linear-gradient(180deg,var(--primary),var(--primary-700));
      border-color:#4a0f22;
    }
    .controls{ display:grid; grid-template-columns:1fr auto auto auto; gap:10px; align-items:center }
    @media (max-width:800px){ .controls{grid-template-columns:1fr 1fr 1fr} .controls .search{grid-column:1/-1} }
    .search{ position:relative }
    .search input{
      width:100%;border-radius:12px;padding:14px 14px 14px 44px;border:1px solid #2a232c;background:#120f14;
      color:#fff;outline:none;transition:.2s border,.2s box-shadow;
    }
    .search input:focus{ border-color:var(--primary); box-shadow:0 0 0 4px var(--ring) }
    .search svg{ position:absolute;left:12px;top:50%;transform:translateY(-50%);opacity:.75 }
    .btn{
      padding:12px 14px;border-radius:12px;border:1px solid #2a232c;background:#141017;color:#fff;
      font-weight:600;cursor:pointer;transition:.2s transform,.2s background,.2s border;white-space:nowrap;
    }
    .btn:hover{transform:translateY(-1px);background:#18111c}
    .btn.primary{background:linear-gradient(180deg,var(--primary) 0%, var(--primary-700) 100%); border-color:#4a0f22}
    .filters{ display:flex;flex-wrap:wrap;gap:10px;margin:14px 0 6px;justify-content:center }
    .chip{
      border:1px solid var(--chip-b);background:var(--chip);color:#e9e5ee;
      padding:8px 12px;border-radius:999px;font-size:12px;cursor:pointer;user-select:none;transition:.15s;
    }
    .chip[data-on="1"]{
      background:linear-gradient(180deg,#34131d, #201219);
      border-color:#5c1a2b; box-shadow:0 0 0 2px rgba(225,29,72,.18), inset 0 0 0 1px rgba(225,29,72,.25);
    }

    /* <<< NOVO >>>  layout flex – cada card tem altura independente */
    .grid{ display:flex; flex-wrap:wrap; gap:18px; align-items:flex-start; }
    details.card{
      flex:1 1 calc(33.333% - 12px);  /* 3 colunas */
      min-width:280px; max-width:100%;
      border-radius:16px;border:1px solid #2b2028;
      background:linear-gradient(180deg,var(--card) 0%, var(--card-2) 100%);
      box-shadow:0 12px 22px var(--shadow), inset 0 0 0 1px rgba(255,255,255,.02);
      overflow:hidden;transition:.2s border,.2s box-shadow;
    }
    @media (max-width:1100px){ details.card{flex-basis:calc(50% - 12px)} }
    @media (max-width:720px){ details.card{flex-basis:100%} }

    details.card[open]{ border-color:#4b2330; box-shadow:0 16px 26px var(--shadow), 0 0 0 4px var(--ring), inset 0 0 0 1px rgba(255,255,255,.03); }
    summary{
      list-style:none;cursor:pointer;display:flex;gap:14px;align-items:center;padding:18px 18px;position:relative;
    }
    summary::-webkit-details-marker{display:none}
    .summary-left{flex:1;min-width:0}
    .name{font-weight:800;font-size:18px;letter-spacing:.3px}
    .ver{font-size:12px;color:#ffd9e1;background:#3b1220;border:1px solid #4f1725;padding:5px 8px;border-radius:10px}
    .chev{ width:22px;height:22px;border-radius:6px;border:1px solid #3a2931;background:#140e12;display:grid;place-items:center;color:#fff;opacity:.9 }
    .cats{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
    .badge{ font-size:11px;padding:6px 8px;border-radius:999px;background:#1a1216;border:1px solid #2a1a22;color:#e9e0e3 }
    .content{padding:0 18px 16px 18px;border-top:1px solid #2b2028}
    .content p{margin:14px 0;color:#eae6ef}
    .kv{display:flex;flex-wrap:wrap;gap:8px}
    .kv .k{font-weight:700;color:#ffedf3}
    .links{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .link{display:inline-flex;gap:8px;align-items:center;background:#140f14;border:1px solid #2a232c;padding:8px 10px;border-radius:10px}
    .link:hover{background:#18111c}
    .empty{opacity:.8}
    footer{margin-top:40px;text-align:center;color:var(--muted-2);font-size:13px}
    .divider{height:1px;background:linear-gradient(90deg,transparent, #3a2430, transparent);margin:16px 0}
    .hint{font-size:12px;color:#b7b3c0;margin-top:8px;text-align:center}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1 class="title">Valheim Modpack</h1>
      <p class="subtitle"></p>

      <div class="tabs">
        <button class="tab on" data-tab="installed">Instalados</button>
        <button class="tab" data-tab="recs">Recomendados</button>
      </div>

      <div class="controls">
        <div class="search">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="#e7d7dc" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          <input id="q" placeholder="Buscar mod, categoria, palavra-chave..." />
        </div>
        <button class="btn" id="expand">Expandir tudo</button>
        <button class="btn" id="collapse">Recolher tudo</button>
        <button class="btn primary" id="copy">Copiar lista</button>
      </div>

      <div class="filters" id="filters"></div>
      <div class="hint">Use busca + filtros. Em cada card: links diretos para pesquisas no Thunderstore, Nexus e Google.</div>
    </header>

    <main class="grid" id="grid"></main>

    <footer>
      <div class="divider"></div>
      Feito para <strong>Valheim v0.221.4</strong> • Última revisão: <span id="rev"></span>
    </footer>
  </div>

  <script>
    // ===== Helpers de link (para ir direto ao resultado correto) =====
    const linkGoogle   = (q)=>`https://www.google.com/search?q=${encodeURIComponent(q)}`;
    const linkTS       = (q)=>`https://www.google.com/search?q=${encodeURIComponent('site:thunderstore.io valheim ' + q)}`;
    const linkNexus    = (q)=>`https://www.google.com/search?q=${encodeURIComponent('site:nexusmods.com valheim ' + q)}`;

    function cardData(name, version, cats, desc, hint){
      return { name, version, cats, desc, hint: hint || name };
    }

    // ====== LISTA (INSTALADOS) — descrições revisadas ======
    const INSTALLED = [
      // Núcleo / libs
      cardData("BepInExPack Valheim","5.4.23",["Biblioteca"],"Pacote do Thunderstore que instala o BepInEx e configura o carregamento de plugins para o Valheim.","BepInExPack Valheim"),
      cardData("Jötunn (JVL)","2.27.0",["Biblioteca"],"API de alto nível para itens/receitas/peças e redes. Muitas criações dependem dela.","Jotunn"),
      cardData("XUnity Resource Redirector","2.1.0",["Biblioteca"],"Sistema de redirecionamento/override de assets, útil para traduções e ajustes de recursos.","XUnity Resource Redirector"),
      cardData("Newtonsoft.Json Detector","1.0.0",["Biblioteca"],"Fornece a lib JSON (Newtonsoft) para mods que serializam dados.","Newtonsoft.Json Valheim"),
      cardData("YamlDotNet Detector","1.0.0",["Biblioteca"],"Biblioteca para ler/gravar YAML, usada por configurações de alguns mods.","YamlDotNet Valheim"),
      cardData("Configuration Manager","18.4.1",["Biblioteca","QoL"],"Painel de configuração no jogo (padrão: F1). Permite mudar valores sem reiniciar.","Configuration Manager Valheim"),

      // UI / HUD / QoL
      cardData("BetterUI","2.5.9",["UI/HUD","QoL"],"Deixa a HUD mais informativa: barras de vida, nomes, cores, experiência e mensagens mais claras.","BetterUI Valheim"),
      cardData("Building Health Display","0.7.1",["UI/HUD","QoL"],"Mostra a vida das peças de construção, ótimo para manutenção e defesa.","Building Health Display Valheim"),
      cardData("Minimal Status Effects","1.0.7",["UI/HUD","QoL"],"Ícones de status compactos/limpos, reduz poluição visual sem perder informação.","Minimal Status Effects Valheim"),
      cardData("Display Day & Time Countdown","1.0.0",["UI/HUD","QoL"],"Exibe o dia atual e um relógio/contador visível na HUD.","Display Day & Time Countdown Valheim"),
      cardData("CameraTweaks","1.3.1",["UI/HUD","QoL"],"Ajuste fino de câmera (FOV, offsets, suavização). Ajuda em combate e construção.","CameraTweaks Valheim"),
      cardData("FirstPersonMode","1.3.10",["UI/HUD","QoL"],"Habilita visão em 1ª pessoa com controles ajustáveis (sem quebrar a mira).","FirstPersonMode Valheim"),
      cardData("SaveCrossbowState","1.0.2",["QoL"],"Mantém a besta pronta/engatilhada entre trocas, poupando tempo em combate.","SaveCrossbowState Valheim"),

      // Inventário / automação
      cardData("AzuExtendedPlayerInventory","1.4.12",["Inventário","QoL"],"Expande o inventário do jogador com layout extra. Compatibilidade ampla (ver notas dos autores).","AzuExtendedPlayerInventory"),
      cardData("AzuCraftyBoxes","1.8.5",["Automação","Inventário"],"Permite craftar usando materiais de baús próximos (raio configurável).","AzuCraftyBoxes"),
      cardData("AzuAutoStore","3.0.8",["Automação","Inventário"],"Botão/atalho para despejar itens em baús apropriados, com whitelist/blacklist.","AzuAutoStore"),
      cardData("Smart Containers Mod","1.7.0",["Automação","Inventário"],"Agrupa baús por tipo (ex.: vegetais, minérios, cogumelos) e organiza automaticamente.","Smart Containers Mod Valheim"),
      cardData("Quick Stack - Store - Sort - Restock","1.4.13",["Inventário","QoL"],"Adiciona botões para organizar, guardar itens iguais e reabastecer consumíveis.","Quick Stack Store Sort Restock Valheim"),
      cardData("Blacksmithing (Skill)","1.3.2",["Skills","Craft"],"Habilidade de ferreiro que evolui ao forjar/usar a forja; valores são configuráveis.","Blacksmithing Valheim"),
      cardData("AutoRepair","5.4.1600",["Automação","QoL"],"Repara automaticamente seus equipamentos ao abrir bancadas compatíveis.","AutoRepair Valheim"),

      // Construção / base
      cardData("OdinArchitect","1.5.7",["Construção","Conteúdo"],"Grande coleção de peças nórdicas/decorativas para bases e vilas temáticas.","OdinArchitect"),
      cardData("Auto Fuel","1.3.1",["Automação","Base"],"Abastece fornos, forjas e lareiras a partir de baús próximos e pode coletar produtos acabados.","Auto Fuel Valheim"),
      cardData("AutomaticFermenters","1.0.8",["Automação","Base"],"Fermentadores com entrada/saída automática: puxa ingredientes e deposita hidroméis prontos.","Automatic Fermenters Valheim"),
      cardData("CookingStationTweaks","0.7.1",["Base","Cozinha","QoL"],"Mais slots por grelha, avisos/tempos e prevenção de queimar alimentos.","Cooking Station Tweaks Valheim"),
      cardData("TorchesEternal","0.2",["Base","QoL"],"Tochas/brasas com duração estendida (ou ilimitada, conforme config).","Torches Eternal Valheim"),
      cardData("StumpsRegrow","1.0.4",["Mundo","Base"],"Tocos de árvore podem rebrotar, facilitando silvicultura sustentável.","StumpsRegrow Valheim"),

      // Agricultura / coleta
      cardData("PlantEverything","1.20.0",["Farming","Conteúdo"],"Permite plantar itens do mundo (ex.: cogumelos, cardo, framboesas, mirtilos, cloudberries) com o cultivador.","Plant Everything Valheim"),
      cardData("PlantEasily","2.0.3",["Farming","Automação","QoL"],"Grade/alinhamento de plantio para fileiras perfeitas, com distância ajustável.","Plant Easily Valheim"),
      cardData("MassFarming","1.11",["Farming","Automação"],"Ações em área (plantar/colher) para acelerar grandes plantações.","MassFarming Valheim"),
      cardData("Farming (Skill)","2.2.1",["Skills","Farming"],"Habilidade de agricultura; bônus configuráveis de rendimento/eficiência.","Farming Skill Valheim"),
      cardData("Mining (Skill)","1.1.5",["Skills"],"Habilidade de mineração; pode ajustar dano em veios e custo de stamina.","Mining Skill Valheim"),

      // Mapa / viagem
      cardData("CartographySkill","3.1.1",["Skills","Mapa"],"Habilidade relacionada a exploração/compartilhamento do mapa (sinergia com mesa de cartografia).","CartographySkill Valheim"),
      cardData("TargetPortal","1.2.1",["Viagem","QoL"],"Portais com seleção de destino por lista (nomeie e escolha para onde viajar).","TargetPortal Valheim"),
      cardData("Sailing (Skill)","1.1.7",["Skills","Viagem"],"Habilidade de navegação que melhora controle/desempenho do barco conforme evolui.","Sailing Skill Valheim"),
      cardData("DiscoveryPins","0.3.10",["Mapa","QoL"],"Cria pinos automaticamente ao descobrir recursos/locais (configurável).","Discovery Pins Valheim"),
      cardData("UnderTheRadar","3.1.7",["Mapa","QoL"],"Mostra colecionáveis, veios e pontos de interesse no minimapa; raio e categorias ajustáveis.","UnderTheRadar Valheim"),

      // Itens / utilitários / montaria
      cardData("Adventure Backpacks","1.9.7",["Itens","QoL"],"Mochilas com slots/efeitos; oferecem utilidade extra e estética aventureira.","Adventure Backpacks Valheim"),
      cardData("Spyglass","3.1.1",["Itens","UI/HUD"],"Luneta para inspecionar à distância e marcar pontos com precisão.","Spyglass Valheim"),
      cardData("OdinHorse","1.5.0",["Montaria","Conteúdo"],"Adiciona cavalos com sela/armadura; montaria rápida para exploração.","OdinHorse Valheim"),

      // Combate / magia / conteúdo
      cardData("Better Archery","1.9.81",["Gameplay","QoL"],"Física de flechas melhorada, recuperação de setas, aljavas e mira mais agradável.","Better Archery Valheim"),
      cardData("Epic Loot","0.11.6",["Loot","Conteúdo"],"Sistema ARPG de raridades e afixos, com encantamento/identificação e progressão de itens.","Epic Loot Valheim"),
      cardData("Creature Level & Loot Control (CLLC)","4.6.4",["Balance","Loot"],"Controla níveis/estrelas, afixos de inimigos e tabelas de drop. Excelente para ajustar a dificuldade.","Creature Level & Loot Control Valheim"),
      cardData("Warfare","1.8.9",["Conteúdo","Combate"],"Grande pacote de armas, sets e progressão de combate.","Therzie Warfare Valheim"),
      cardData("Armory","1.3.1",["Conteúdo","Craft"],"Estação/árvore de craft que integra o conteúdo do Warfare.","Therzie Armory Valheim"),
      cardData("Warfare Fire & Ice","2.0.8",["Conteúdo","Combate"],"Expansão elemental (fogo/gelo) para o arsenal do Warfare.","Therzie Warfare Fire and Ice Valheim"),
      cardData("Wizardry","1.1.8",["Magia","Conteúdo"],"Cajados/varinhas, armaduras de Eitr e progressão mágica compatível com Valheim atual.","Therzie Wizardry Valheim"),
      cardData("MagicPlugin (blacks7ar)","2.1.8",["Magia","Conteúdo"],"Itens e feitiços adicionais focados em magia; complementa sistemas místicos.","MagicPlugin blacks7ar Valheim"),
      cardData("RenegadeVikings (blacks7ar)","1.3.9",["Conteúdo","Eventos"],"Inimigos humanóides, encontros e equipamentos temáticos de vikings renegados.","RenegadeVikings blacks7ar Valheim"),
      cardData("Shield Me Bruh!","1.1.1",["Combate","QoL"],"Ajustes de escudos (timing/parry) para tornar a defesa mais responsiva.","Shield Me Bruh Valheim"),
      cardData("Monstrum","1.5.1",["Conteúdo","Mobs"],"Novas criaturas e, em alguns pacotes, chefes/variantes desafiadoras.","Therzie Monstrum Valheim"),
      cardData("Seasonality","3.5.0",["Mundo","Imersão"],"Estações do ano com climas e visuais customizáveis, afetam a atmosfera do mundo.","Seasonality Valheim"),

      // Extras
      cardData("TranslationsHelper","1.2.8",["Biblioteca"],"Infra de localização para textos/strings personalizados.","TranslationsHelper Valheim"),
      cardData("Passive Powers","1.1.3",["Gameplay","QoL"],"Permite configurar certos poderes guardiões como efeitos passivos/alternativos, conforme regras do mod.","Passive Powers Valheim")
    ];

    // ====== RECOMENDADOS (complementam seu pack sem repetir) ======
    // Observação: mantidos como sugestões populares e compatíveis no estilo do seu modpack.
    const RECS = [
      rec("Ward Is Love","Base","Gestão avançada de wards: permissões por jogador, área ampliada e QoL para proteger base.","Ward Is Love Valheim"),
      rec("Jewelcrafting (RandyKnapp)","Loot","Gemas para engastar em equipamentos (sinergia forte com Epic Loot). Requer Extended Item Data Framework.","Jewelcrafting RandyKnapp Valheim"),
      rec("Extended Item Data Framework (EIDF)","Biblioteca","Framework necessário para gemas/soquetes e outros mods orientados a dados.","Extended Item Data Framework Valheim"),
      rec("Equipment & Quick Slots","Inventário","Acrescenta slots dedicados (anel/capa/etc.) e atalhos rápidos. Ver compat. com inventário estendido.","Equipment and Quick Slots Valheim"),
      rec("Item Drawers","Inventário","Gavetas de armazenamento com exibição do item; ótima sinergia com AzuAutoStore/Smart Containers.","Item Drawers Valheim"),
      rec("PlanBuild","Construção","Planejamento de construção (blueprints/planos) para erguer bases gigantes com custo controlado.","PlanBuild Valheim"),
      rec("Snap Points Made Easy","Construção","Pontas de encaixe e snapping facilitados; agiliza alinhamento de peças com precisão.","Snap Points Made Easy Valheim"),
      rec("Item Stand All Items","Construção","Coloque praticamente qualquer item em pedestais/stands para decoração temática.","Item Stand All Items Valheim"),
      rec("Simple Recycling","Craft","Recicle equipamentos para recuperar parte dos materiais — perfeito para limpeza de baús.","Simple Recycling Valheim"),
      rec("Better Trader (Remake)","Economia","Mercador mais útil: mais itens, categorias e preços equilibráveis.","Better Trader Remake Valheim"),
      rec("AllTameable (Buzz)","Mobs","Permite domar mais criaturas (com equilíbrio configurável), expandindo a vida na base.","AllTameable Valheim"),
      rec("BoneAppetit / Cooking Skill","Cozinha","Habilidade/cozinha estendida para quem curte culinária profunda. Escolha a variante compatível mais recente.","Valheim cooking skill mod")
    ];
    function rec(name, cat, desc, hint){ return { name, version:"—", cats:[cat,"Sugerido"], desc, hint }; }

    // ====== Renderização comum ======
    const grid = document.querySelector('#grid');
    const filtersEl = document.querySelector('#filters');
    const qEl = document.querySelector('#q');
    const REV = document.querySelector('#rev');
    const tabs = document.querySelectorAll('.tab');
    REV.textContent = new Date().toISOString().slice(0,10);

    let ACTIVE = 'installed'; // installed | recs
    let ON = new Set();       // filtros ativos

    function dataset(){ return ACTIVE==='installed' ? INSTALLED : RECS; }

    function buildFilterChips(){
      filtersEl.innerHTML='';
      ON.clear();
      const cats = Array.from(new Set(dataset().flatMap(m=>m.cats))).sort((a,b)=>a.localeCompare(b,'pt-BR'));
      for(const c of cats){
        const chip = document.createElement('button');
        chip.className='chip'; chip.textContent=c; chip.dataset.on='0';
        chip.onclick = ()=>{
          chip.dataset.on = chip.dataset.on==='1' ? '0' : '1';
          if(chip.dataset.on==='1') ON.add(c); else ON.delete(c);
          render();
        };
        filtersEl.appendChild(chip);
      }
    }

    function card(mod){
      const id = mod.name.toLowerCase().replace(/[^a-z0-9]+/g,'-');
      const el = document.createElement('details'); el.className='card'; el.id = id;

      const sum = document.createElement('summary');
      const left = document.createElement('div'); left.className='summary-left';

      const name = document.createElement('div'); name.className='name'; name.textContent = mod.name;
      const cats = document.createElement('div'); cats.className='cats';
      for(const c of mod.cats){ const b = document.createElement('span'); b.className='badge'; b.textContent=c; cats.appendChild(b); }
      const ver = document.createElement('span'); ver.className='ver'; ver.textContent = `v${mod.version}`;
      const chev = document.createElement('div'); chev.className='chev';
      chev.innerHTML = '<svg width="14" height="14" viewBox="0 0 24 24" fill="none"><path d="M7 10l5 5 5-5" stroke="#ffe5ec" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>';

      left.appendChild(name); left.appendChild(cats);
      sum.appendChild(left); sum.appendChild(ver); sum.appendChild(chev);
      el.appendChild(sum);

      const ct = document.createElement('div'); ct.className='content';
      ct.innerHTML = `
        <p>${mod.desc}</p>
        <div class="kv"><span class="k">Atalhos:</span> <span class="v empty">geralmente configuráveis no <strong>F1</strong> (Configuration Manager)</span></div>
        <div class="links">
          <a class="link" href="${linkTS(mod.hint)}" target="_blank" rel="noopener">Thunderstore</a>
          <a class="link" href="${linkNexus(mod.hint)}" target="_blank" rel="noopener">Nexus Mods</a>
          <a class="link" href="${linkGoogle(mod.hint)}" target="_blank" rel="noopener">Google</a>
        </div>
      `;
      el.appendChild(ct);
      return el;
    }

    function render(){
      const text = qEl.value.trim().toLowerCase();
      grid.innerHTML='';
      const shown = dataset()
        .filter(m=>{
          if(ON.size && !m.cats.some(c=>ON.has(c))) return false;
          if(text){
            const hay = (m.name+' '+m.cats.join(' ')+' '+m.desc).toLowerCase();
            return hay.includes(text);
          }
          return true;
        })
        .sort((a,b)=>a.name.localeCompare(b.name,'pt-BR'));

      for(const m of shown) grid.appendChild(card(m));
    }

    // Eventos
    qEl.addEventListener('input', render);
    document.querySelector('#expand').onclick = ()=>document.querySelectorAll('details.card').forEach(d=>d.open=true);
    document.querySelector('#collapse').onclick = ()=>document.querySelectorAll('details.card').forEach(d=>d.open=false);
    document.querySelector('#copy').onclick = async ()=>{
      const list = dataset().slice().sort((a,b)=>a.name.localeCompare(b.name,'pt-BR')).map(m=>`${m.name} ${m.version && m.version!=='—' ? 'v'+m.version : ''}`.trim()).join('\n');
      try{ await navigator.clipboard.writeText(list); flash('Lista copiada!'); }catch{ flash('Falhou ao copiar — selecione manualmente.'); }
    };
    tabs.forEach(t=>{
      t.onclick = ()=>{
        tabs.forEach(x=>x.classList.remove('on')); t.classList.add('on');
        ACTIVE = t.dataset.tab === 'recs' ? 'recs' : 'installed';
        buildFilterChips(); render();
      };
    });

    function flash(msg){
      const n = document.createElement('div');
      n.textContent = msg;
      n.style.position='fixed'; n.style.left='50%'; n.style.top='18px'; n.style.transform='translateX(-50%)';
      n.style.background='linear-gradient(180deg,var(--primary),var(--primary-700))';
      n.style.padding='10px 14px'; n.style.border='1px solid #4a0f22'; n.style.borderRadius='10px';
      n.style.boxShadow='0 8px 20px var(--shadow)'; n.style.zIndex='9999';
      document.body.appendChild(n); setTimeout(()=>n.remove(),1600);
    }

    // Init
    buildFilterChips(); render();
  </script>
</body>
</html>
